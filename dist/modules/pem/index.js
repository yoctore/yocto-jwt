/* yocto-jwt - Manage jwt token, and encrypt/decrypt all request based on jwt webtoken and cert - V1.1.0 */
"use strict";function Pem(){this.state=!1}var pem=require("pem"),Q=require("q"),_=require("lodash");Pem.prototype.processJwt=function(){var a=Q.defer(),b=this;return pem.createCertificate({days:1,selfSigned:!0},function(c,d){var e={};c?a.reject(c):(_.merge(e,d),pem.getPublicKey(d.certificate,function(c,d){c?a.reject(c):(_.merge(e,d),b.state=!0,a.resolve(e))}))}),a.promise},Pem.prototype.verify=function(a,b){var c=Q.defer();return pem.getModulus(a,function(a,d){a?c.reject(a):pem.getModulus(b,function(a,b){a||d.modulus!==b.modulus?c.reject(a?a:"certificate not match with given key"):c.resolve()})}),c.promise},Pem.prototype.isReady=function(){return this.state},module.exports=new Pem;